name: "cargo-fmt-bot"
author: "Marco Ieni"
description: "GitHub action to automatically format your Rust code"
inputs:
  commit_message:
    description: "Commit message to use when committing the changes. If not provided, the default 'chore: format' is used."
    default: "chore: format"
    required: false
branding:
  icon: "zap"
  color: "yellow"
runs:
  using: "composite"
  steps:
    - name: Configure git user from GitHub token
      uses: MarcoIeni/git-config@v0.1
    - name: Run cargo fmt bot
      shell: bash
      run: |
        cargo fmt --all

        # If repository has uncommitted changes, commit them
        if [[ -n $(git status -s) ]]
        then
            git add .
            git commit -m "${{ inputs.commit_message }}"
            git push
        fi
